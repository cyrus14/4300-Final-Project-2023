{% extends 'base.html' %}

{% block title %}
home
{% endblock %}

{% block body %}

<body>

  <div class="main"></div>

  <div class="full-body-container">
    <div class="top-text">
      <div class="title-colors">
        <h1 id="title-t">apollocate</h1>

      </div>

      <select class="city-select" id="city">
        <option value="New_York_City">New York City, USA</option>
        <option value="London">London, UK</option>
        <option value="Mumbai">Mumbai, IND</option>
        <option value="Toronto">Toronto, CAN</option>
        <option value="Tokyo">Tokyo, JPN</option>
        <option value="Tel_Aviv">Tel Aviv, IS</option>
        <option value="Seoul">Seoul, KOR</option>
      </select>

      <div class="spacer"></div>

      <select class="js-example-basic-multiple" name="tags[]" multiple="multiple">
      </select>


      <div class="spacer"></div>

      <button onclick='myFunction()' class="generate-playlist-btn">generate playlist</button>
      <div id="loading-wheel"></div>

      <!--
            <table>
                <thead>
                  <tr>
                    <th>Song</th>
                    <th>Artist</th>
                  </tr>
                </thead>
                <tbody>
                  {% for item in data %}
                    <tr>
                      <td>{{ item }}</td>
                      <td>{{ item }}</td>
                    </tr>
                  {% endfor %}
                </tbody>
              </table>
            -->



      <!-- <div class="input-box" onclick="sendFocus()">
                <img src="{{ url_for('static', filename='images/mag.png') }}" />
                <input placeholder="Search for a Keeping up with the Kardashians episode" id="filter-text-val" onkeyup="filterText()">
            </div> -->

    </div>
    <div id="answer-box">

    </div>
  </div>



  <script>
    data =['peaceful', 'springlike', 'warm', 'tragic', 'anxiety', 'funereal', 'quiet', 'fighting', 'funny', 'happiness', 'dreary', 'excite', 'elegiac', 'rowdy', 'paranoid', 'intensive', 'bitter', 'outrageous', 'bittersweet', 'angst-ridden', 'poignant', 'high spirits', 'feverish', 'heartbroken', 'celebrate', 'sooth', 'savage', 'playful', 'fun', 'happy music', 'fiery', 'excited', 'happy', 'aggression', 'ebullient', 'cheerup', 'serenity', 'humor', 'rebel', 'peace', 'moving', 'jolly', 'depressed', 'tense', 'tragedy', 'comfort', 'unhappy', 'melancholic', 'fight', 'delicate', 'calmness', 'bleak', 'joyful', 'gentle', 'campy', 'unfortunate', 'happy songs', 'festive', 'grim', 'aggressive', 'mournful', 'rough', 'zest', 'romantic', 'hostile', 'tranquil', 'heartbreaking', 'boisterous', 'cheer-up', 'desire', 'sadness', 'silly', 'blue', 'merry', 'military', 'misery', 'sorrow', 'martial', 'crusty', 'vigorous', 'lamenting', 'sad', 'calm', 'dark', 'cheerful', 'confrontational', 'soothe', 'frightening', 'cheer', 'fury', 'wintry', 'desperate', 'celebratory', 'passionate', 'lament', 'untroubled', 'autumnal', 'heartbreak', 'funeral', 'rebellious', 'furious', 'exhilarating', 'passion', 'march', 'relax', 'weep', 'joyous', 'rollicking', 'arousing', 'intense', 'volatile', 'unworried', 'outraged', 'exciting', 'weltschmerz', 'anguished', 'introspective', 'contemplate', 'tender', 'sorry', 'anxious', 'anger', 'mellow', 'annoying', 'quietly', 'somber', 'plaintive', 'brokenheart', 'calmed', 'contemplative', 'rambunctious', 'conflict', 'tough', 'humorous', 'bright', 'touching', 'weeping', 'excitement', 'mourn', 'relaxing', 'serene', 'melancholy', 'marching', 'relaxed', 'visceral', 'angst', 'sexy', 'angry', 'depressive', 'rage', 'introverted', 'ardor', 'severe', 'spooky', 'detached', 'animated', 'gloomy', 'unconcerned', 'thrilling', 'thrill', 'smooth', 'dreamy', 'despondent', 'miserable', 'energetic', 'lively', 'harsh', 'apocalyptic', 'soft', 'party', 'eerie', 'revolt', 'confident', 'peppy', 'gleeful', 'cry', 'vigor', 'amiable', 'depressing', 'macabre', 'quietness', 'grief', 'troubled', 'soothing', 'enraged', 'cheering', 'mad', 'sob', 'glad', 'fear', 'dejected', 'enthusiastic', 'sobbing', 'crying', 'fierce', 'nervous']

    $(document).ready(function() {
      $('.js-example-basic-multiple').select2({data : data});
    })

    var selectElement = document.getElementById("city");

    for (var i = 0; i < selectElement.options.length; i++) {
      if (selectElement.options[i].value === keyParam) {
        selectElement.selectedIndex = i;
        break;
      }
    }

    function moodAggregator() {
      let moods = ""

      var selectedMoods = document.getElementsByClassName('select2-selection__choice');
      
      for (e of selectedMoods) {
        moods = moods + e.getAttribute('title')
      }

      console.log(moods)

      return moods
    }

    function myFunction() {
      var loadingWheel = document.querySelector('#loading-wheel');
      var city = document.getElementById("city").value
      loadingWheel.style.display = 'block';

      let moods = ""

      var selectedMoods = document.getElementsByClassName('select2-selection__choice');
      
      for (e of selectedMoods) {
        var attr = e.getAttribute('title')
        
        moods = moods + e.getAttribute('title')
      }

      console.log(moods)

      window.location.href = '/results?key=' + city + '&mood=' + moods

    }


    function answerBoxTemplate(title, titleDesc) {
      return `<div class=''>
                <h3 class='episode-title'>${title}</h3>
                <p class='episode-desc'>${titleDesc}</p>
            </div>`
    }

    function sendFocus() {
      document.getElementById('filter-text-val').focus()
    }

    function filterText() {
      document.getElementById("answer-box").innerHTML = ""
      console.log(document.getElementById("filter-text-val").value)
      fetch("/episodes?" + new URLSearchParams({ title: document.getElementById("filter-text-val").value }).toString())
        .then((response) => response.json())
        .then((data) => data.forEach(row => {

          let tempDiv = document.createElement("div")
          tempDiv.innerHTML = answerBoxTemplate(row.title, row.descr)
          document.getElementById("answer-box").appendChild(tempDiv)
        }));

    }

  </script>
</body>

{% endblock %}