{% extends 'base.html' %}

{% block title %}
home
{% endblock %}

{% block body %}

<body>

  <div class="main"></div>

  <div class="full-body-container">
    <div class="top-text">
      <div class="title-colors">
        <h1 id="title-t">apollocate</h1>

      </div>

      <select class="city-select" id="city" style="font-family: 'DM Sans', sans-serif; height: 30px;">
        <option value="New_York_City">New York City, USA</option>
        <option value="Budapest">Budapest, HUN</option>
        <option value="Ithaca">Ithaca, USA</option>
        <option value="Miami">Miami, USA</option>
        <option value="Los_Angeles">Los Angeles, USA</option>
        <option value="Chicago">Chicago, USA</option>
        <option value="Houston">Houston, USA</option>
        <option value="Phoenix">Phoenix, USA</option>
        <option value="Philadelphia">Philadelphia, USA</option>
        <option value="San_Antonio">San Antonio, USA</option>
        <option value="San_Diego">San Diego, USA</option>
        <option value="Dallas">Dallas, USA</option>
        <option value="San_Jose">San Jose, USA</option>
        <option value="Austin">Austin, USA</option>
        <option value="San_Francisco">San Francisco, USA</option>
        <option value="Seattle">Seattle, USA</option>
        <option value="Denver">Denver, USA</option>
        <option value="Nashville">Nashville, USA</option>
        <option value="Washington">Washington, USA</option>
        <option value="Oklahoma_City">Oklahoma City, USA</option>
        <option value="Boston">Boston, USA</option>
        <option value="Las_Vegas">Las Vegas, USA</option>
        <option value="Memphis">Memphis, USA</option>
        <option value="Detroit">Detroit, USA</option>
        <option value="Baltimore">Baltimore, USA</option>
        <option value="Tel_Aviv">Tel Aviv, IS</option>
        <option value="Jerusalem">Jerusalem, IS</option>
        <option value="Seoul">Seoul, KOR</option>
        <option value="New_Orleans">New Orleans, USA</option>
        <option value="Paris">Paris, FRA</option>
        <option value="Tokyo">Tokyo, JPN</option>
        <option value="Delhi">Delhi, IND</option>
        <option value="Shanghai">Shanghai, CHN</option>
        <option value="Mexico_City">Mexico City, MEX</option>
        <option value="Cairo">Cairo, EGY</option>
        <option value="Mumbai">Mumbai, IND</option>
        <option value="Beijing">Beijing, CHN</option>
        <option value="Osaka">Osaka, JPN</option>
        <option value="Buenos_Aires">Buenos Aires, ARG</option>
        <option value="Istanbul">Istanbul, TUR</option>
        <option value="Guangzhou">Guangzhou, CHN</option>
        <option value="Bangkok">Bangkok, THA</option>
        <option value="London">London, UK</option>
        <option value="Hong_Kong">Hong Kong, HKG</option>
        <option value="Madrid">Madrid, ESP</option>
        <option value="Toronto">Toronto, CAN</option>
        <option value="Atlanta">Atlanta, USA</option>
      </select>
      

      <div class="spacer"></div>

      <select class="js-example-basic-multiple" name="tags[]" multiple="multiple" data-placeholder="Type a mood tag... (ex. happy)" style="font-family: 'DM Sans', sans-serif;">
      </select>


      <div class="spacer"></div>

      <button onclick='myFunction()' class="generate-playlist-btn">generate playlist</button>

      <div class="spacer"></div>
      
      <div id="loading-wheel"></div>

  </div>

  <script>
    function matchStart(params, data) {
      // If there are no search terms, return all of the data
      if ($.trim(params.term) === '') {
        return data;
      }

      // Skip if there is no 'children' property
      if (typeof data.children === 'undefined') {
        return null;
      }

      // `data.children` contains the actual options that we are matching against
      var filteredChildren = [];
      $.each(data.children, function (idx, child) {
        if (child.text.toUpperCase().indexOf(params.term.toUpperCase()) == 0) {
          filteredChildren.push(child);
        }
      });

      // If we matched any of the timezone group's children, then set the matched children on the group
      // and return the group object
      if (filteredChildren.length) {
        var modifiedData = $.extend({}, data, true);
        modifiedData.children = filteredChildren;

        // You can return modified objects from here
        // This includes matching the `children` how you want in nested data sets
        return modifiedData;
      }

      // Return `null` if the term should not be displayed
      return null;
    }

    $(document).ready(function() {
  $('.city-select').select2({
    minimumInputLength: 0,
    placeholder: 'Select an option',
    width: '250px', // set the dropdown width to 100% of the parent element
    selectOnFocus: true
  });
});

    
  </script>

<script>
  document.body.style.zoom = "125%";
</script>

  <script>
    data =['peaceful', 'springlike', 'warm', 'tragic', 'anxiety', 'funereal', 'quiet', 'fighting', 'funny', 'happiness', 'dreary', 'excite', 'elegiac', 'rowdy', 'paranoid', 'intensive', 'bitter', 'outrageous', 'bittersweet', 'angst-ridden', 'poignant', 'feverish', 'heartbroken', 'celebrate', 'sooth', 'savage', 'playful', 'fun', 'fiery', 'excited', 'happy', 'aggression', 'ebullient', 'cheerup', 'serenity', 'humor', 'rebel', 'peace', 'moving', 'jolly', 'depressed', 'tense', 'tragedy', 'comfort', 'unhappy', 'melancholic', 'fight', 'delicate', 'calmness', 'bleak', 'joyful', 'gentle', 'campy', 'unfortunate', 'festive', 'grim', 'aggressive', 'mournful', 'rough', 'zest', 'romantic', 'hostile', 'tranquil', 'heartbreaking', 'boisterous', 'cheer-up', 'desire', 'sadness', 'silly', 'blue', 'merry', 'military', 'misery', 'sorrow', 'martial', 'crusty', 'vigorous', 'lamenting', 'sad', 'calm', 'dark', 'cheerful', 'confrontational', 'soothe', 'frightening', 'cheer', 'fury', 'wintry', 'desperate', 'celebratory', 'passionate', 'lament', 'untroubled', 'autumnal', 'heartbreak', 'funeral', 'rebellious', 'furious', 'exhilarating', 'passion', 'march', 'relax', 'weep', 'joyous', 'rollicking', 'arousing', 'intense', 'volatile', 'unworried', 'outraged', 'exciting', 'weltschmerz', 'anguished', 'introspective', 'contemplate', 'tender', 'sorry', 'anxious', 'anger', 'mellow', 'annoying', 'quietly', 'somber', 'plaintive', 'brokenheart', 'calmed', 'contemplative', 'rambunctious', 'conflict', 'tough', 'humorous', 'bright', 'touching', 'weeping', 'excitement', 'mourn', 'relaxing', 'serene', 'melancholy', 'marching', 'relaxed', 'visceral', 'angst', 'sexy', 'angry', 'depressive', 'rage', 'introverted', 'ardor', 'severe', 'spooky', 'detached', 'animated', 'gloomy', 'unconcerned', 'thrilling', 'thrill', 'smooth', 'dreamy', 'despondent', 'miserable', 'energetic', 'lively', 'harsh', 'apocalyptic', 'soft', 'party', 'eerie', 'revolt', 'confident', 'peppy', 'gleeful', 'cry', 'vigor', 'amiable', 'depressing', 'macabre', 'quietness', 'grief', 'troubled', 'soothing', 'enraged', 'cheering', 'mad', 'sob', 'glad', 'fear', 'dejected', 'enthusiastic', 'sobbing', 'crying', 'fierce', 'nervous']

    $(document).ready(function() {
      $('.js-example-basic-multiple').select2({data : data});
    })

    var selectElement = document.getElementById("city");

    for (var i = 0; i < selectElement.options.length; i++) {
      if (selectElement.options[i].value === keyParam) {
        selectElement.selectedIndex = i;
        break;
      }
    }

    function myFunction() {
      var loadingWheel = document.querySelector('#loading-wheel');
      var city = document.getElementById("city").value
      loadingWheel.style.display = 'block';

      let moods = ""

      var selectedMoods = document.getElementsByClassName('select2-selection__choice');
      
      for (e of selectedMoods) {
        var attr = e.getAttribute('title')
        moods = moods + attr + "_"
      }

      moods = moods.slice(0, -1)
      
      window.location.href = '/results?key=' + city + '&moods=' + moods

      window.location.href= '/test?key=' + city + '&moods=' + moods;
    }


    function answerBoxTemplate(title, titleDesc) {
      return `<div class=''>
                <h3 class='episode-title'>${title}</h3>
                <p class='episode-desc'>${titleDesc}</p>
            </div>`
    }

    function sendFocus() {
      document.getElementById('filter-text-val').focus()
    }

    function filterText() {
      document.getElementById("answer-box").innerHTML = ""
      console.log(document.getElementById("filter-text-val").value)
      fetch("/episodes?" + new URLSearchParams({ title: document.getElementById("filter-text-val").value }).toString())
        .then((response) => response.json())
        .then((data) => data.forEach(row => {

          let tempDiv = document.createElement("div")
          tempDiv.innerHTML = answerBoxTemplate(row.title, row.descr)
          document.getElementById("answer-box").appendChild(tempDiv)
        }));

    }

  </script>
</body>

{% endblock %}