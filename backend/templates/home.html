{% extends 'base.html' %}

{% block title %}
home
{% endblock %}

{% block body %}

<body>

  <div class="main"></div>

  <div class="full-body-container">
    <div class="top-text">
      <div class="title-colors">
        <h1 id="title-t">apollocate</h1>

      </div>

      <select class="city-select" id="city" style="font-family: 'DM Sans', sans-serif; height: 30px;">
        <option value="New_York_City">New York City, USA</option>
        <option value="Budapest">Budapest, HUN</option>
        <option value="Ithaca,_New_York">Ithaca, USA</option>
        <option value="Miami">Miami, USA</option>
        <option value="Los_Angeles">Los Angeles, USA</option>
        <option value="Chicago">Chicago, USA</option>
        <option value="Houston">Houston, USA</option>
        <option value="Phoenix">Phoenix, USA</option>
        <option value="Philadelphia">Philadelphia, USA</option>
        <option value="San_Antonio">San Antonio, USA</option>
        <option value="San_Diego">San Diego, USA</option>
        <option value="Dallas">Dallas, USA</option>
        <option value="San_Jose">San Jose, USA</option>
        <option value="Austin">Austin, USA</option>
        <option value="San_Francisco">San Francisco, USA</option>
        <option value="Seattle">Seattle, USA</option>
        <option value="Denver">Denver, USA</option>
        <option value="Nashville">Nashville, USA</option>
        <option value="Washington">Washington, USA</option>
        <option value="Oklahoma_City">Oklahoma City, USA</option>
        <option value="Boston">Boston, USA</option>
        <option value="Las_Vegas">Las Vegas, USA</option>
        <option value="Memphis">Memphis, USA</option>
        <option value="Detroit">Detroit, USA</option>
        <option value="Baltimore">Baltimore, USA</option>
        <option value="Tel_Aviv">Tel Aviv, IS</option>
        <option value="Jerusalem">Jerusalem, IS</option>
        <option value="Seoul">Seoul, KOR</option>
        <option value="New_Orleans">New Orleans, USA</option>
        <option value="Paris">Paris, FRA</option>
        <option value="Tokyo">Tokyo, JPN</option>
        <option value="Delhi">Delhi, IND</option>
        <option value="Shanghai">Shanghai, CHN</option>
        <option value="Mexico_City">Mexico City, MEX</option>
        <option value="Cairo">Cairo, EGY</option>
        <option value="Mumbai">Mumbai, IND</option>
        <option value="Beijing">Beijing, CHN</option>
        <option value="Osaka">Osaka, JPN</option>
        <option value="Buenos_Aires">Buenos Aires, ARG</option>
        <option value="Istanbul">Istanbul, TUR</option>
        <option value="Guangzhou">Guangzhou, CHN</option>
        <option value="Bangkok">Bangkok, THA</option>
        <option value="London">London, UK</option>
        <option value="Hong_Kong">Hong Kong, HKG</option>
        <option value="Madrid">Madrid, ESP</option>
        <option value="Toronto">Toronto, CAN</option>
        <option value="Atlanta">Atlanta, USA</option>
      </select>


      <div class="spacer"></div>

      <select class="js-example-basic-multiple" name="tags[]" multiple="multiple"
        data-placeholder="Enter a mood (ex. happy)" style="font-family: 'DM Sans', sans-serif; height: 30px;">
      </select>


      <div class="spacer"></div>

      <button onclick='myFunction()' class="generate-playlist-btn">generate playlist</button>

      <div class="spacer"></div>

      <div id="loading-wheel"></div>

    </div>

    <script>
      function matchStart(params, data) {
        // If there are no search terms, return all of the data
        if ($.trim(params.term) === '') {
          return data;
        }

        // Skip if there is no 'children' property
        if (typeof data.children === 'undefined') {
          return null;
        }

        // `data.children` contains the actual options that we are matching against
        var filteredChildren = [];
        $.each(data.children, function (idx, child) {
          if (child.text.toUpperCase().indexOf(params.term.toUpperCase()) == 0) {
            filteredChildren.push(child);
          }
        });

        // If we matched any of the timezone group's children, then set the matched children on the group
        // and return the group object
        if (filteredChildren.length) {
          var modifiedData = $.extend({}, data, true);
          modifiedData.children = filteredChildren;

          // You can return modified objects from here
          // This includes matching the `children` how you want in nested data sets
          return modifiedData;
        }

        // Return `null` if the term should not be displayed
        return null;
      }

      $(document).ready(function () {
        $('.city-select').select2({
          minimumInputLength: 0,
          placeholder: 'Select an option',
          width: '250px', // set the dropdown width to 100% of the parent element
          selectOnFocus: true
        });
      });


    </script>

    <script>
      document.body.style.zoom = "125%";
    </script>

    <script>
      data = ['unhappy', 'touching', 'moving', 'dreamy', 'calm', 'sorrow', 'glad', 'lively', 'heartbroken', 'playful', 'arousing', 'ardor', 'harsh', 'contemplative', 'sobbing', 'bitter', 'thrilling', 'dreary', 'romantic', 'cheerful', 'blue', 'visceral', 'rebellious', 'merry', 'frightening', 'confrontational', 'depressing', 'gloomy', 'tranquil', 'campy', 'soft', 'unconcerned', 'spooky', 'vigorous', 'dejected', 'aggressive', 'lamenting', 'crying', 'mellow', 'unfortunate', 'dark', 'enthusiastic', 'humorous', 'passionate', 'exhilarating', 'fury', 'savage', 'elegiac', 'serene', 'sexy', 'angst', 'fear', 'rambunctious', 'animated', 'paranoid', 'martial', 'furious', 'boisterous', 'energetic', 'tender', 'unworried', 'celebratory', 'marching', 'despondent', 'quiet', 'comfort', 'severe', 'feverish', 'outraged', 'autumnal', 'rollicking', 'soothing', 'introverted', 'bright', 'gentle', 'silly', 'joyful', 'sooth', 'fierce', 'crusty', 'tense', 'fun', 'party', 'tough', 'somber', 'poignant', 'amiable', 'anxious', 'march', 'sorry', 'weeping', 'grief', 'peppy', 'gleeful', 'mournful', 'funny', 'revolt', 'rough', 'brokenheart', 'untroubled', 'smooth', 'high spirits', 'ebullient', 'sad', 'relaxed', 'outrageous', 'nervous', 'funeral', 'peaceful', 'hostile', 'serenity', 'desperate', 'anguished', 'rage', 'excited', 'happy', 'jolly', 'tragic', 'miserable', 'mad', 'rowdy', 'desire', 'introspective', 'springlike', 'bittersweet', 'grim', 'intense', 'fighting', 'detached', 'troubled', 'plaintive', 'confident', 'angry', 'macabre', 'weltschmerz', 'wintry', 'annoying', 'bleak', 'warm', 'volatile', 'enraged', 'zest', 'delicate', 'melancholic', 'festive', 'apocalyptic', 'fiery', 'military', 'conflict', 'eerie'].sort()
      console.log(data);

      $(document).ready(function () {
        $('.js-example-basic-multiple').select2({ data: data });
      })

      var selectElement = document.getElementById("city");

      for (var i = 0; i < selectElement.options.length; i++) {
        if (selectElement.options[i].value === keyParam) {
          selectElement.selectedIndex = i;
          break;
        }
      }

      function myFunction() {
        var loadingWheel = document.querySelector('#loading-wheel');
        var city = document.getElementById("city").value
        loadingWheel.style.display = 'block';

        let moods = ""

        var selectedMoods = document.getElementsByClassName('select2-selection__choice');

        for (e of selectedMoods) {
          var attr = e.getAttribute('title')
          moods = moods + attr + "_"
        }

        moods = moods.slice(0, -1)

        window.location.href = '/results?key=' + city + '&moods=' + moods

        // window.location.href= '/test?key=' + city + '&moods=' + moods;
      }


      function answerBoxTemplate(title, titleDesc) {
        return `<div class=''>
                <h3 class='episode-title'>${title}</h3>
                <p class='episode-desc'>${titleDesc}</p>
            </div>`
      }

      function sendFocus() {
        document.getElementById('filter-text-val').focus()
      }

      function filterText() {
        document.getElementById("answer-box").innerHTML = ""
        console.log(document.getElementById("filter-text-val").value)
        fetch("/episodes?" + new URLSearchParams({ title: document.getElementById("filter-text-val").value }).toString())
          .then((response) => response.json())
          .then((data) => data.forEach(row => {

            let tempDiv = document.createElement("div")
            tempDiv.innerHTML = answerBoxTemplate(row.title, row.descr)
            document.getElementById("answer-box").appendChild(tempDiv)
          }));

      }

    </script>
</body>

{% endblock %}